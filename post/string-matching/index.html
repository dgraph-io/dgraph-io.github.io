<!DOCTYPE html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1">
    <link rel="canonical" href="https://blog.dgraph.io/post/string-matching/" />


    <link rel="apple-touch-icon" sizes="57x57" href="https://dgraph.io/assets/images/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://dgraph.io/assets/images/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://dgraph.io/assets/images/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://dgraph.io/assets/images/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://dgraph.io/assets/images/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://dgraph.io/assets/images/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://dgraph.io/assets/images/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://dgraph.io/assets/images/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://dgraph.io/assets/images/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="https://dgraph.io/assets/images/favicons/android-icon-192x192.png">
    <link rel="manifest" href="https://dgraph.io/assets/images/favicons/manifest.json">
    <link rel="icon" type="image/png" sizes="32x32" href="https://dgraph.io/assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="https://dgraph.io/assets/images/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://dgraph.io/assets/images/faviconsfavicon-16x16.png">
    <link rel="shortcut icon" href="https://dgraph.io/assets/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="https://dgraph.io/assets/images/faviconsms-icon-144x144.png">
    <meta name="msapplication-config" content="https://dgraph.io/assets/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://blog.dgraph.io//index.xml">
  
    <title>String matching in Dgraph v0.7.5 - Dgraph Blog</title>
    <meta property='og:title' content="String matching in Dgraph v0.7.5 - Dgraph Blog">
    <meta property="og:type" content="article">
  

  <meta property="og:url" content="https://blog.dgraph.io/post/string-matching/">
  
  <meta property="og:image" content="https://blog.dgraph.io//images/splitting-dunes.jpg">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" integrity="sha256-0rguYS0qgS6L4qVzANq4kjxPLtvnp5nn2nB5G1lWRv4=" crossorigin="anonymous"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/default.min.css" rel="stylesheet" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js" integrity="sha256-sNPiigbfSkqUzMc5rgrdztLnneCMAp6W9wetJUZu9Zw=" crossorigin="anonymous"></script>

  <link
    href='https://blog.dgraph.io//css/runnable.css?7bbf71b4888bc97241e85bc7326a12fe'
    rel="stylesheet"
  />
  <link
    href='https://blog.dgraph.io//css/runnable-custom.css?74110b504a7b8a6e92a95279cfa96032'
    rel="stylesheet"
  />

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />

  <link href="https://dgraph.io/assets/css/style.min.css?06042020-8" rel="stylesheet" type="text/css" />

  <link href="https://dgraph.io/assets/css/font-awesome/css/all.css" rel="stylesheet"/>

  <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.js" integrity="sha256-x3BtPVERvw1ozPlwivuFLZoViFCeAAs1Gt6SxEedmo8=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.css" integrity="sha256-7sZe9dsqyNZC9Mk+WPRB7nVvPPPXyorzm2QKqlgXC4k=" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/edit/closebrackets.min.js" integrity="sha256-qhu2a7DSpQaammMaLw1iruxBpxmgdw8mdQaQWQUokcY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js" integrity="sha256-7Bdg/UdDMmHDPafpQDYZNPCEbnRP7eAvu+2hEoqRCXs=" crossorigin="anonymous"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:ital@1&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/algoliasearch@3/dist/algoliasearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.0.0/dist/instantsearch.production.min.js" integrity="sha256-6S7q0JJs/Kx4kb/fv0oMjS855QTz5Rc2hh9AkIUjUsk=" crossorigin="anonymous"></script>
  <script src="https://blog.dgraph.io//js/search.js?04292020"></script>

  
  
    
      <meta name="twitter:card" content="summary_large_image"/>
      <meta name="twitter:image" content="https://blog.dgraph.io//images/splitting-dunes.jpg"/>
    
  

  <meta name="twitter:title" content="String matching in Dgraph v0.7.5"/>
  <meta name="twitter:description" content="The recent release of Dgraph is packed with new features and improvements.
Many of them are related to strings - full text search (with support for 15 languages!) and regular expression matching have been added, and handling of string values in multiple languages was greatly improved.
All of these changes make Dgraph an excellent tool for working with multilingual applications."/>
  <meta name="twitter:site" content="@dgraphlabs"/>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-666192333"></script>
  <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-666192333');</script>
</head>


<body class="blog-single has-lightning" data-gr-c-s-loaded="true">

    <header id="page-header" class="page-header">
	<div class="page-logo">
		<a href="https://dgraph.io/">
			<img src="https://dgraph.io/assets/images/logo.svg">
		</a>
	</div>
	<nav class="page-nav">
    <ul>
        <li>
            <div data-label="Products">
                <span>Products</span>
            </div>
            <ul>
                <li>
                    <a href="https://dgraph.io/graphql" data-label="GraphQL">
                        <span>GraphQL</span>
                    </a>
                </li>
                <li>
                    <a href="https://dgraph.io/enterprise" data-label="Enterprise">
                        <span>Enterprise</span>
                    </a>
                </li>
                <li>
                    <a href="https://dgraph.io/downloads" data-label="Downloads">
                        <span>Downloads</span>
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <div data-label="Learn" class="is-active">
                <span>Learn</span>
            </div>
            <ul>
                <li>
                    <a href="https://dgraph.io/blog" data-label="Blog">
                        <span>Blog</span>
                    </a>
                </li>
                <li>
                    <a href="https://tour.dgraph.io" target="_blank" data-label="Interactive Tour">
                        <span>Interactive Tour</span>
                    </a>
                </li>
                <li>
                    <a href="https://discuss.dgraph.io" target="_blank" data-label="Forum">
                        <span>Forum</span>
                    </a>
                </li>
                <li>
                    <a href="https://slack.dgraph.io" target="_blank" data-label="Slack">
                        <span>Slack</span>
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <div data-label="Docs"><span>Docs</span></div>
            <ul>
                <li>
                    <a href="https://docs.dgraph.io" target="_blank" data-label="Dgraph Docs">
                        <span>Dgraph Docs</span>
                    </a>
                </li>
                <li>
                    <a href="https://graphql.dgraph.io/docs/" target="_blank" data-label="GraphQL Docs">
                        <span>GraphQL Docs</span>
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <div data-label="Company"><span>Company</span></div>
            <ul>
                <li>
                    <a href="https://dgraph.io/about" data-label="Team">
                        <span>Team</span>
                    </a>
                </li>
                <li>
                    <a href="https://dgraph.io/careers" data-label="Careers">
                        <span>Careers</span>
                    </a>
                </li>
                <li>
                    <a href="https://dgraph.io/contact" data-label="Contact">
                        <span>Contact</span>
                    </a>
                </li>
                <li>
                    <a href="https://dgraph.io/conduct" data-label="Conduct">
                        <span>Conduct</span>
                    </a>
                </li>
            </ul>
        </li>
    </ul>
</nav>

	<div class="page-cta">
    <ul>
        <li class="hide-tablet">
            <a href="https://dgraph.io/contact" title="Contact">Contact</a>
        </li>
        <li>
            <a href="https://dgraph.io/downloads" title="Download" class="button button--secondary">
                <span>Download</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </li>
    </ul>
</div>

</header>




    <section class="page-body">
        <div class="page-body__content">
            <div class="container">

                <div class="page-search">
	<div class="page-search__toggle" onClick="toggleVisibility()">
		<i class="fas fa-search"></i>
		<i class="fas fa-times"></i>
	</div>
</div>

          

            <div class="row">

                <div class="col-12 col-md-8">
                    <div class="page-body__content post">

                        <div class="post__meta">

                            <div class="post__date">

    
        Mon, Apr 10, 2017
    
    
</div>


                            <div class="post__share">
                                
                                    <a href="https://twitter.com/share?text=String%20matching%20in%20Dgraph%20v0.7.5&amp;url=https%3a%2f%2fblog.dgraph.io%2fpost%2fstring-matching%2f&amp;via=dgraphlabs" target="_blank">
                                        <i class="fab fa-twitter"></i>
                                    </a>
                                
                            </div>

                        </div>

                        <div class="post__cover">

                            <img src="https://blog.dgraph.io//images/splitting-dunes.jpg">

                            <div class="post__header">

                                <h1 class="post__title">
                                    String matching in Dgraph v0.7.5
                                </h1>

                                
<div class="post__byline">

    
            by <a href="https://blog.dgraph.io/authors/tzdybal/">Tomasz Zdybał</a>
        
    

</div>



                            </div>

                        </div>

                        <div class="post__content inner-content">
                            <p>The recent release of Dgraph is packed with new features and improvements.
Many of them are related to strings - full text search (with support for 15 languages!) and regular expression matching have been added, and handling of string values in multiple languages was greatly improved.
All of these changes make Dgraph an excellent tool for working with multilingual applications.</p>

<h3 id="values-in-many-languages">Values in Many Languages</h3>

<p>We&rsquo;re working hard to keep the query language easy to use and clean.
Dgraph, in v0.7.5, adopted and extended the language tag syntax from the RDF N-Quads standard.
It is intuitive, well-known, and was partially supported in previous versions (during data loading).</p>

<p>Let&rsquo;s start from the beginning - the data.
Dgraph uses RDF N-Quads for data loading and backup.
String literals in N-Quads may be followed by the <code>@</code> sign and language tag, e.g. <code>&quot;badger&quot;@en</code> or <code>&quot;Dachs&quot;@de</code>.
Multiple such literals may be used as a value for a single entity/attribute pair.</p>

<p>When querying for a predicate with multiple values, the user is able to use the <code>@lang</code> notation known from RDF N-Quads.
Many languages can be specified in a list of preference, e.g. <code>@en:de</code> denotes that preferred language is English, but if such a value is not present, a value in German should be returned.</p>

<p>Language can also be specified in functions, which is important especially for full text search.</p>

<h3 id="example-data">Example Data</h3>

<p>The dataset used in all examples is the <a href="https://github.com/dgraph-io/benchmarks/blob/master/data/21million.rdf.gz">Freebase film data</a>.
As this post is string-oriented, queries are focused on movie titles in multiple languages, and no other information is retrieved.
As we don&rsquo;t have information about type of <code>name</code>, we use filtering to select only the movie titles, and to limit the number of results a bit - <code>@filter(gt(count(genre), 1))</code>.</p>

<p>The schema for <code>name</code> field is very simple - it defines 3 types of indexes:</p>

<pre><code>curl localhost:8080/query -XPOST -d $'
mutation {
  schema {
    name: string @index(term, fulltext, exact) .
  }
}' | python -m json.tool | less
</code></pre>

<p><code>term</code> index is used for term matching with the <code>allofterms</code> and <code>anyofterms</code> functions.
Note that it was the only string index available in previous releases of Dgraph.</p>

<p><code>fulltext</code> index uses matching with language specific stemming and stopwords.
One thing worth noting is, that values indexed with <code>fulltext</code> are processed according to their&rsquo;s language (if they are tagged). If values are untagged, English is used as a default language.</p>

<p><code>exact</code> index is used for regular expression matching.</p>

<h3 id="full-text-search-fts">Full Text Search (FTS)</h3>

<h5 id="very-short-introduction-to-natural-language-processing-nlp">Very Short Introduction to Natural Language Processing (NLP)</h5>

<p>By definition (from <a href="https://en.wikipedia.org/wiki/Full-text_search">Wikipedia</a>):</p>

<pre><code class="language-html">In a full-text search, a search engine examines all of the words in every stored document as it tries to match search criteria (for example, text specified by a user).
</code></pre>

<p>This may sound trivial, but it&rsquo;s not.
Searching for exact form of the word is not always satisfying for the user.
For example, nouns can be singular or plural, verbs have grammatical tenses, etc., and the user may be interested in all values related to the word in any inflected or derived form.</p>

<p>The simple but powerful idea is to find a method, that can transform all the forms of a word to some common base.
This process is called <strong>stemming</strong>.
For many natural languages (including English) stemmers may be implemented using a set of well known grammatical rules.
There are also languages (like Polish) where a dictionary based approach is required (i.e. inflected form -&gt; stem mapping).</p>

<p>Only for languages with well known grammatical rules are stemmers are widely available.</p>

<p>Another problem with search are the words that are common, like <code>the</code>, <code>is</code>, or <code>at</code>.
In most cases, searching for them gives an enormous amount of results which are useless.
Those words are called <strong>stop words</strong>.
Again, stop words are language specific.
The common method of handling those words is just to remove them from the search.</p>

<h5 id="dgraph-fts-nlp-processing">Dgraph FTS/NLP Processing</h5>

<p>The following steps are applied to both data (while indexing), and the query pattern:</p>

<ol>
<li>Tokenization - text is divided into words.</li>
<li>Normalization - all letters are transformed to lowercase. <a href="http://unicode.org/reports/tr15/">Unicode Normalization</a> is applied.</li>
<li>Stop words are removed.</li>
<li>Stemming is applied.</li>
</ol>

<p>Since stop words contain inflected forms, they are removed before stemming.</p>

<h5 id="full-text-search-functions">Full Text Search Functions</h5>

<p>There are two new functions that provide basic support for full text search:</p>

<ol>
<li><code>alloftext</code> - searches for values that contain all the specified words (using NLP).</li>
<li><code>anyoftext</code> - searches for values that contain one or more of the specified tokens (using NLP).</li>
</ol>

<h5 id="examples">Examples</h5>

<p>Let&rsquo;s query for <code>white or maybe black</code>, using the term matching function <code>allofterms</code>.</p>

<p>

<div class="runnable" data-checksum="a2c60948e744862d6b1a13236ada9dd9" data-initial="{
  movie(func:allofterms(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
" data-current="{
  movie(func:allofterms(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:allofterms(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:allofterms(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:allofterms(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:allofterms(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

The query gives no results.
It may be worth trying less strict match with <code>alloftext</code> function:</p>



<div class="runnable" data-checksum="5d5001b78c162fe12067167cabc9bab5" data-initial="{
  movie(func:alloftext(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
" data-current="{
  movie(func:alloftext(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:alloftext(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:alloftext(name@en, &#34;white or maybe black&#34;)) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:alloftext(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:alloftext(name@en, "white or maybe black")) @filter(gt(count(genre), 1)) {
    name@en
    name@de
    name@it
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>Query returns 59 results.
This example shows that removing a stop word may help in some cases.</p>

<p>In context of NLP, English is quite easy - there are no diacritics, and inflection is rather simple.
So let&rsquo;s try similar query in German:</p>



<div class="runnable" data-checksum="ae14be08ee0c46175f71b7918ee1dcd0" data-initial="{
  movie(func:allofterms(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
" data-current="{
  movie(func:allofterms(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:allofterms(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:allofterms(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:allofterms(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:allofterms(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>Again, the query doesn&rsquo;t return any results.</p>

<p>Now let&rsquo;s try the NLP-enabled version of this query:</p>



<div class="runnable" data-checksum="3ae8ed3ca59fc7f3927a4ca09377ab47" data-initial="{
  movie(func:alloftext(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
" data-current="{
  movie(func:alloftext(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:alloftext(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:alloftext(name@de, &#34;weiss oder vielleicht schwarz&#34;)) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:alloftext(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:alloftext(name@de, "weiss oder vielleicht schwarz")) @filter(gt(count(genre), 1)) {
	name@de
	name@en
	name@it
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>This returns 4 results.</p>

<p>It&rsquo;s worth noting the inflected forms of <code>schwarz</code> - <code>schwarzes</code> and <code>Schwartze</code>.
Also the <code>Wei\u00dfer</code> is interesting - <code>\u00df</code> is the escaped Unicode value of <a href="https://en.wikipedia.org/wiki/%C3%9F">grapheme <code>ß</code></a>.
<code>weiss</code> matched <code>Weißer</code> - the form is inflected, and grapheme equivalency is preserved.
Like in the English example, the stop word (<code>oder</code>) is ignored.</p>

<h5 id="gotchas">Gotchas</h5>

<p>In some cases, natural language processing can lead to surprising results.
Let&rsquo;s search for the answer to the famous question: <code>To be, or not to be?</code>:</p>



<div class="runnable" data-checksum="aadb70fa6d64fde240a20a76965babec" data-initial="{
  movie(func:alloftext(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
" data-current="{
  movie(func:alloftext(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:alloftext(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:alloftext(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:alloftext(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:alloftext(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>The query gives no results, while the term matching query:</p>



<div class="runnable" data-checksum="dd1fdb51dcb706bd6314b6e67b0d9118" data-initial="{
  movie(func:allofterms(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
" data-current="{
  movie(func:allofterms(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:allofterms(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:allofterms(name@en, &#34;To be, or not to be?&#34;)) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:allofterms(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:allofterms(name@en, "To be, or not to be?")) @filter(gt(count(genre), 1)) {
	name@en
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>gives two results:</p>

<p>What happened? <code>To be, or not to be?</code> consists of stop words only.
After FTS/NLP processing, there are no movies that match the query.</p>

<h3 id="regular-expressions-regexp">Regular Expressions (regexp)</h3>

<p>Regular expressions are extremely useful for creating sophisticated matchers.</p>

<p>For example, all titles starting with a word containing <code>night</code> but not <code>knight</code> may be matched using following query:</p>



<div class="runnable" data-checksum="23ed524490f96aec36c54a4a839190a0" data-initial="{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
" data-current="{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
" data-dirty="false">
  <div class="container-fluid">
    <div class="row">
      <div class="runnable-col runnable-col-code col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="topbar">

            <div class="normal-header">
              <div class="row">
                <div class="col-10">
                  <nav class="nav-languages">
                    <a class="language active" data-action="nav-lang" data-target="query" href="#">Query</a>
                    <a class="language" data-action="nav-lang" data-target="curl" href="#">Curl</a>
                    <a class="language" data-action="nav-lang" data-target="java" href="#">Java</a>
                  </nav>
                </div>
                <div class="col-2">
                  <div class="actions pull-right">
                    <a class="code-btn" data-action="run" href="#">Run</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="editing-header">
              <div class="row">
                <div class="col-12">
                  <span class="pane-title">
                    Editing query...
                  </span>
                </div>
              </div>
            </div>

          </div>

          <div class="runnable-content runnable-code">
            <div class="runnable-tab-content active" data-tab="query">
              <pre><code class="no-copy"><span class="query-content">{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
</span></code></pre>

            </div>

            <div class="runnable-tab-content" data-tab="edit">
              <textarea class="query-content-editable">{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
</textarea>
            </div>

            <div class="runnable-tab-content" data-tab="curl">
              <pre><code class="no-copy" tabindex="-1">curl localhost:8080/query -XPOST -d '
<span class="query-content">{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
</span>' | python -m json.tool | less</code></pre>
            </div>

            <div class="runnable-tab-content" data-tab="java">
              <pre><code class="no-copy" tabindex="-1">import io.dgraph.client.DgraphClient;
import io.dgraph.client.GrpcDgraphClient;
import io.dgraph.client.DgraphResult;

public class DgraphMain {
  public static void main(final String[] args) {
    final DgraphClient dgraphClient = GrpcDgraphClient.newInstance("localhost", 8080);
    final DgraphResult result = dgraphClient.query("<span class="query-content java">{
  movie(func:regexp(name@en, /^[a-zA-z]*[^Kk ]?[Nn]ight/)) @filter(gt(count(genre), 1)) {
	name@en
	name@de
	name@it
  }
}
</span>");
    System.out.println(result.toJsonObject().toString());
  }
}</code></pre>
            </div>
          </div>

          <div class="row footer">
            <div class="col-12">
              <div class="actions pull-right">
                <div class="edit-actions">
                  <a class="code-btn" data-action="reset" href="#">Reset</a>
                  <a class="code-btn" data-action="discard" href="#">Discard</a>
                  <a class="code-btn" data-action="save" href="#"><i class="fa fa-save"></i> Save</a>
                </div>
                <div class="normal-actions">
                  <a class="code-btn" data-action="edit" href="#"><i class="fa fa-edit"></i> Edit query</a>
                  <span class="code-btn" data-action="copy-code" href="#">Copy</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="runnable-col runnable-col-output col-12 col-sm-12 col-md-12 col-lg-6 nopadding">
        <div class="runnable-pane">
          <div class="row topbar">
            <div class="col-12">
              <span class="pane-title">
                Response
              </span>
            </div>
          </div>

          <div class="runnable-content runnable-output" style="background: url('https://blog.dgraph.io//images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
            <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
          </div>

          <div class="row footer">
            <div class="col-12 col-sm-8">
              <div class="latency-info hidden">
                <div class="stat server-latency">
                  <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="bottom" data-html="true" title="Latency information" data-animation="false"></i>
                </div>
                <div class="stat network-latency">
                  <span class="label">Network latency:</span> <span class="number"></span>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-4">
              <div class="actions pull-right">
                <a class="code-btn hidden-sm-down" data-action="expand" href="#"><i class="fa fa-expand"></i></a>
                <span class="code-btn" data-action="copy-output" href="#">Copy</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<p>There are 502 results in the test dataset.</p>

<h3 id="summary">Summary</h3>

<p>Dgraph supports extensive, and useful methods of string matching.</p>

<p>Natural language processing, employed for full text search, may be the best choice for lookup based on users input.
If more strict matching is required, term matching should give good results.
And to get the most precise results of complicated text searches, regular expressions can be used.</p>



<aside class="post__references">

    <h4>References</h4><p>Top image: <a href="https://www.nasa.gov/image-feature/jpl/pia21572/the-splitting-of-the-dunes">The Splitting of the Dunes</a></p>
</aside>
                        </div>

                        
    <aside class="post__authors">
                <div class="tile author-tile">

    <img src="https://blog.dgraph.io/images/people/tomasz.jpg" class="author-tile__photo">

    <h4 class="author-tile__title">
        <a href="https://blog.dgraph.io/authors/tzdybal/">Tomasz Zdybał</a>,
        Author
    </h4>

    <p>Tomasz gained experience in diverse projects including real time embedded
software, banking backend and distributed systems. He wanted to work on database
system implementation since high school.</p>

<p>Programming is his greatest passion but he also likes trekking, skiing, cross
country cycling and photography.</p>


    
        <nav class="author-tile__social">

            
                <a href="https://www.linkedin.com/in/tzdybal/" target="_blank">
                    <i class="fab fa-linkedin"></i>
                </a>
            

            
                <a href="https://twitter.com/tzdybal" target="_blank">
                    <i class="fab fa-twitter"></i>
                </a>
            

            
                <a href="https://github.com/tzdybal" target="_blank">
                    <i class="fab fa-github"></i>
                </a>
            

        </nav>
    

</div>

            
        

    </aside>



                        <div class="post__comments">

    <div id="discourse-comments"></div>

    
    <script type="text/javascript">
        DiscourseEmbed = {
            discourseUrl: "https:\/\/discuss.dgraph.io\/",
            topicId:  1700 
            };
        (function() {
            var d = document.createElement("script");
            d.type = "text/javascript";
            d.async = true;
            d.src = DiscourseEmbed.discourseUrl + "javascripts/embed.js";
            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(d);
        })();
    </script>
    <noscript>Please enable JavaScript to view the comments on <a href="https://discuss.dgraph.io/">discuss</a>.</noscript>
    

</div>


                        <div class="modal fade" id="runnable-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <a href="#" data-dismiss="modal" class="modal-close-btn">
    Close
  </a>

  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">

      </div>
    </div>
  </div>
</div>

                    </div>
                </div>

                <div class="col-12 col-md-4 col-lg-3 offset-lg-1">
                    <div class="page-body__sidebar">

                        






                        


                        <aside class="post__cta">

    <h3>
        Deploy Dgraph<br>
        in Minutes
    </h3>

    <p>Dgraph does more than just simplify your workload. Discover what makes Dgraph GraphQL the best option for the job.</p>

    <a href="https://dgraph.io/downloads" class="button button--secondary">
        <span>Download</span>
        <i class=" fas fa-arrow-right"></i>
    </a>

</aside>


                    </div>
                </div>

            </div>
        </div>
    </section>

    <footer class="page-footer">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-5 col-sm-4">
        <div class="row">
          <div class="col-12 col-md-6 page-footer__nav">
            <h3 class="zeta">Products</h3>
            <ul>
              <li><a href="https://dgraph.io/graphql">GraphQL</a></li>
              <li><a href="https://dgraph.io/enterprise">Enterprise</a></li>
              <li><a href="https://dgraph.io/downloads">Downloads</a></li>
            </ul>
          </div>
          <div class="col-12 col-md-6 page-footer__nav">
            <h3 class="zeta">Learn</h3>
            <ul>
              <li><a href="https://dgraph.io/blog" target="_blank">Blog</a></li>
              <li><a href="https://tour.dgraph.io" target="_blank">Interactive Tour</a></li>
              <li><a href="https://discuss.dgraph.io" target="_blank">Forum</a></li>
              <li><a href="https://slack.dgraph.io" target="_blank">Slack</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-5 col-sm-4">
        <div class="row">
          <div class="col-12 col-md-6 page-footer__nav">
            <h3 class="zeta">Docs</h3>
            <ul>
              <li><a href="https://docs.dgraph.io" target="_blank">Dgraph Docs</a></li>
              <li><a href="https://graphql.dgraph.io/docs/" target="_blank">GraphQL Docs</a></li>
            </ul>
          </div>
          <div class="col-12 col-md-6 page-footer__nav">
            <h3 class="zeta">Company</h3>
            <ul>
              <li><a href="https://dgraph.io/about">Team</a></li>
              <li><a href="https://dgraph.io/careers">Careers</a></li>
              <li><a href="https://dgraph.io/contact">Contact</a></li>
              <li><a href="https://dgraph.io/conduct">Conduct</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 offset-lg-1 border-above-sm">
        <div class="page-footer__cta"><a href="https://dgraph.io/downloads" title="Download" class="button button--secondary"><span>Download</span><i class="fas fa-arrow-right"></i></a></div>
        <div class="page-footer__address">
          <p>
            655 Montgomery Street, 7th Floor<br>
            San Francisco, CA 94111
          </p>
          <hr>
          <p><a href="mailto:contact@dgraph.io">contact@dgraph.io</a></p>
        </div>
      </div>
    </div>
    <div class="page-footer__social">
      <ul>
        <li><a href="https://twitter.com/dgraphlabs" target="_blank"><i class="fab fa-twitter"></i></a></li>
        <li><a href="https://github.com/dgraph-io/dgraph" target="_blank"><i class="fab fa-github"></i></a></li>
        <li><a href="https://www.youtube.com/channel/UCghE41LR8nkKFlR3IFTRO4w" target="_blank"><i class="fab fa-youtube"></i></a></li>
        <li><a href="https://slack.dgraph.io" target="_blank"><i class="fab fa-slack"></i></a></li>
        <li><a href="https://www.linkedin.com/company/dgraph-labs" target="_blank"><i class="fab fa-linkedin"></i></a></li>
      </ul>
    </div>
    <div class="page-footer__copyright">
      <p>
        <Copyright>&copy; 2017-2020 Dgraph Labs, Inc.</Copyright>
      </p>
    </div>
  </div>
</footer>

    <script src="https://blog.dgraph.io//js/clipboard.min.js"></script>
    <script
      src='https://blog.dgraph.io//js/runnable.js?29f8ba4fb8d90804cf24ff53b70192ad'
    ></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>




<script>
  window.Countly = window.Countly || {};
  Countly.q = Countly.q || [];

  Countly.q.push(['track_sessions']);
  Countly.q.push(['track_pageview']);
  (function() {
  	var cly = document.createElement('script');
  	cly.type = 'text/javascript';
  	cly.async = true;
  	cly.src = "https://dgraph.io/assets/js/unminified/stats/dgraph-stats.min.js";
  	cly.onload = function() {
      Countly.init({
        app_key: "e93284ab5e5d21ef9eb16a94516b3c1c6eba1015",
        url: "https://stats.dgraph.io",
        force_post: true,
      })
  	};
  	document.body.appendChild(cly);
  })();
</script>


<script>
$(document.links)
  .filter(function() {
    return this.hostname != window.location.hostname;
  })
  .attr("target", "_blank");
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/visibility.js/1.2.4/visibility.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">
<link
  href='https://blog.dgraph.io//css/heart.css?24a50879951b2391f04750723b4a012e'
  rel="stylesheet">
<link
  href='https://blog.dgraph.io//css/github-engage.css?d60d80bf2b6a24350cdb5d834ab47e27'
  rel="stylesheet">

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"
  integrity="sha256-7/yoZS3548fXSRXqc/xYzjsmuW3sFKzuvOCHd06Pmps="
  crossorigin="anonymous"
></script>
<script
  type="text/javascript"
  src='https://blog.dgraph.io//js/custom.js?94f0c667422b8dac293e14c9c49872e3'
></script>

<script src="//unpkg.com/@dgraph-io/community"></script>


</body>

    <script src="https://blog.dgraph.io/js/footnotes.js"></script>

</html>

